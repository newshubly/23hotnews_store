<!-- MVP.css quickstart template: https://github.com/andybrewer/mvp/ -->

<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="icon" href="https://via.placeholder.com/70x70">
    <link rel="stylesheet" href="https://andybrewer.github.io/mvp/mvp.css">
    <link rel="stylesheet" href="main.css">
    <meta charset="utf-8">
    <meta name="description" content="My description">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <title>Hotnews</title>
</head>

<body>
    <main>
        <hr>
        <section id="section-1">
            <header>
                <h2>Section Heading</h2>
                <p>Section Subheading</p>
            </header>
            <aside>
                <h3>Card heading</h3>
                <p>Card content*</p>
                <p><small>*with small content</small></p>
            </aside>
            <!-- <aside>
                <h3>Card heading</h3>
                <p>Card content <sup>with notification</sup></p>
            </aside>
            <aside>
                <h3>Card heading</h3>
                <p>Card content</p>
            </aside>
            <aside>
                <h3>Card heading</h3>
                <p>Card content</p>
            </aside>
            <aside>
                <h3>Card heading</h3>
                <p>Card content</p>
            </aside> -->
        </section>
        <hr>
        <article>
            <aside>
                <h3>Card heading</h3>
                <p>Card content</p>
            </aside>
        </article>
    </main>
    <footer>
        <hr>
        <p>
            <small>Contact info</small>
        </p>
    </footer>
    <script type="text/javascript">
        (function () {
            var date = new Date();
            date.setMinutes(date.getMinutes() - 66);
            var url = geturl(dateToYMD(date));

            $.get(url, function (data, status) {
                var news_list = data.split('\n').map(JSON.parse);
                console.log(news_list);
                news_list.forEach(function (item, i) {
                    var card = "<aside><h3><a href='" + item.link + "' target='_blank'>" + item.title + "</a></h3>";
                    // <p>" + item.summary + "</p>"
                    // + "<p>" + item.published_my + "</p>" +
                    // +"<small><p>" + item.label + "</small></p>" +
                    // + "</aside>";

                    if (isNaN(item.summary)) {
                        card += "<p>" + item.summary + "</p>";
                    }
                    if (isNaN(item.published_my)) {
                        card += "<p>" + item.published_my + "</p>";
                    }
                    if (isNaN(item.label)) {
                        card += "<small><p>" + item.label + "</small></p>";
                    }
                    if (isNaN(item.site)) {
                        if (item.site != item.label) {
                            card += "<small><p>" + item.site + "</small></p>";
                        }
                    }
                    // console.log(i);
                    // console.log(typeof(item))
                    console.log(item);
                    $('#section-1').append(card);
                })
                // $(".result").html(data);
                // $("#hotterm-preview").html(marked(data));
                // toc();
                // $("#category").prepend('<h3>Hot Term(' + date + ')</h2>');
                //alert(status);
                //alert( "Load was performed." );
            }).fail(function () {
                alert('zzz' + status);
            });
        })();


        function toc() {
            $("h2,h3,h4,h5,h6").each(function (i, item) {
                var tag = $(item).get(0).localName;
                $(item).attr("id", "wow" + i);
                $("#category").append('<a class="new' + tag + '" href="#wow' + i + '">' + $(this).text() + '</a></br>');
                $(".newh2").css("margin-left", 0);
                $(".newh3").css("margin-left", 20);
                $(".newh4").css("margin-left", 40);
                $(".newh5").css("margin-left", 60);
                $(".newh6").css("margin-left", 80);
            });
        }
        function dateToYMD(date) {
            var d = date.getDate();
            var m = date.getMonth() + 1; //Month from 0 to 11
            var y = date.getFullYear();
            var h = date.getHours();
            m = (m <= 9 ? '0' + m : m);
            d = (d <= 9 ? '0' + d : d);
            h = (h <= 9 ? '0' + h : h);
            return y + '/' + m + '/' + d + '/' + y + m + '' + d + '_' + h;
        }
        function geturl(d) {
            https://raw.githubusercontent.com/newshubly/23hotnews_store/master/json/2023/09/05/20230905_18_hotnews.json
            var url_prefix = "https://raw.githubusercontent.com/newshubly/23hotnews_store/master/json/";
            return url_prefix + d + '_hotnews.json'
        }
        $(document).ready(function () {
            $(document).on('click', '.ui-btn-top', function (evt) {
                evt.preventDefault();
                $('html, body').animate({ scrollTop: 0 }, 300); //http://api.jquery.com/animate/
            });
        });
    </script>
</body>

</html>